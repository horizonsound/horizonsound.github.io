{% if include.playlist %}
<div class="playlist-carousel">

  <!-- LEFT ARROW -->
  <button class="carousel-arrow left-arrow">‹</button>

  <!-- SCROLLING STRIP -->
  <div class="horizontal-strip">
    {% for item in include.playlist %}
      {% assign song_id = item.url | split: "/" | last %}
      {% assign song = site.songs | where: "song_id", song_id | first %}
      {% if song %}
        <div class="playlist-tile" data-song="{{ song.song_id }}">
          <img src="{{ item.image }}" alt="{{ song.title }}">
          <h3 class="tile-title">{{ song.title }}</h3>
        </div>
      {% endif %}
    {% endfor %}
  </div>

  <!-- RIGHT ARROW -->
  <button class="carousel-arrow right-arrow">›</button>

</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const tiles = document.querySelectorAll(".playlist-tile");
  const iframe = document.querySelector(".video-wrapper iframe");

  if (!tiles.length || !iframe) return;

  tiles.forEach(tile => {
    tile.addEventListener("click", () => {
      const songId = tile.dataset.song;

      // Find the matching song in window.allSongs (if available)
      const song = window.allSongs?.find(s => s.song_id === songId);

      if (!song) return;

      // Update the embed
      iframe.src = "https://www.youtube.com/embed/" + song.youtube_id;

      // Update active tile highlight
      document.querySelectorAll(".playlist-tile").forEach(t => t.classList.remove("active-tile"));
      tile.classList.add("active-tile");

      // Scroll tile into view
      tile.scrollIntoView({ behavior: "smooth", inline: "center", block: "nearest" });
    });
  });
});
</script>
{% endif %}
